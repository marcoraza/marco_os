import{a as u,j as e}from"./vendor-motion-Bf_hqqYm.js";import{I as x,S as C,C as _,c as h}from"./index-Dv6BZTtJ.js";import"./vendor-charts-CffnG748.js";function I(d){return d.replace(/```([\s\S]*?)```/g,'<pre class="bg-bg-base border border-border-panel rounded p-3 text-xs font-mono overflow-x-auto my-2"><code>$1</code></pre>').replace(/`([^`]+)`/g,'<code class="bg-bg-base border border-border-panel rounded px-1.5 py-0.5 text-xs font-mono">$1</code>').replace(/^### (.+)$/gm,'<h3 class="text-sm font-bold text-text-primary mt-3 mb-1">$1</h3>').replace(/^## (.+)$/gm,'<h2 class="text-base font-bold text-text-primary mt-4 mb-1">$1</h2>').replace(/^# (.+)$/gm,'<h1 class="text-lg font-bold text-text-primary mt-4 mb-2">$1</h1>').replace(/\*\*(.+?)\*\*/g,'<strong class="font-bold">$1</strong>').replace(/\*(.+?)\*/g,'<em class="italic">$1</em>').replace(/~~(.+?)~~/g,'<del class="line-through text-text-secondary">$1</del>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener" class="text-accent-blue underline hover:text-accent-blue/80">$1</a>').replace(/^[-*] (.+)$/gm,'<li class="ml-4 list-disc text-sm">$1</li>').replace(/^\d+\. (.+)$/gm,'<li class="ml-4 list-decimal text-sm">$1</li>').replace(/^---$/gm,'<hr class="border-border-panel my-3" />').replace(/^> (.+)$/gm,'<blockquote class="border-l-2 border-accent-blue pl-3 text-text-secondary italic my-2">$1</blockquote>').replace(/\n\n/g,'<div class="h-3"></div>').replace(/\n/g,"<br />")}function z(d,i,f){const{selectionStart:o,selectionEnd:m,value:p}=d,a=p.slice(o,m);let s="",r=0;switch(i){case"bold":s=`**${a||"texto"}**`,r=a?s.length:2;break;case"italic":s=`*${a||"texto"}*`,r=a?s.length:1;break;case"heading":s=`## ${a||"Título"}`,r=s.length;break;case"code":s=a.includes(`
`)?`\`\`\`
${a||"código"}
\`\`\``:`\`${a||"código"}\``,r=a?s.length:a.includes(`
`)?4:1;break;case"list":s=a?a.split(`
`).map(n=>`- ${n}`).join(`
`):"- item",r=s.length;break;case"link":s=`[${a||"texto"}](url)`,r=a?s.length-1:1;break;case"strikethrough":s=`~~${a||"texto"}~~`,r=a?s.length:2;break;case"quote":s=a?a.split(`
`).map(n=>`> ${n}`).join(`
`):"> citação",r=s.length;break}const b=p.slice(0,o)+s+p.slice(m);f(b),requestAnimationFrame(()=>{d.focus();const n=o+r;d.setSelectionRange(n,n)})}const D=[{action:"bold",icon:"format_bold",label:"Negrito"},{action:"italic",icon:"format_italic",label:"Itálico"},{action:"strikethrough",icon:"strikethrough_s",label:"Riscado"},{action:"heading",icon:"title",label:"Título"},{action:"code",icon:"code",label:"Código"},{action:"list",icon:"format_list_bulleted",label:"Lista"},{action:"quote",icon:"format_quote",label:"Citação"},{action:"link",icon:"link",label:"Link"}],A=({notes:d,setNotes:i,activeProjectId:f})=>{const[o,m]=u.useState(null),[p,a]=u.useState(""),[s,r]=u.useState(!0),[b,n]=u.useState(!1),k=u.useRef(null),y=d.filter(t=>!t.projectId||t.projectId===f),j=y.find(t=>t.id===o),v=()=>{var w;const t=p.trim()||"Nota sem título",l=new Date().toISOString(),c=((w=crypto==null?void 0:crypto.randomUUID)==null?void 0:w.call(crypto))??`note-${Date.now()}`,g={id:c,title:t,body:"",createdAt:l,updatedAt:l,projectId:f};i(S=>[g,...S]),m(c),a(""),n(!1)},N=u.useCallback(t=>{o&&i(l=>l.map(c=>c.id===o?{...c,body:t,updatedAt:new Date().toISOString()}:c))},[o,i]),$=t=>{i(l=>l.filter(c=>c.id!==t)),o===t&&m(null)};return e.jsxs("div",{className:"flex flex-col h-full overflow-hidden p-4 gap-4",children:[e.jsx("div",{className:"flex items-center justify-between shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{name:"sticky_note_2",size:"lg",className:"text-accent-orange"}),e.jsxs("div",{children:[e.jsx(C,{className:"text-[12px] text-text-primary tracking-[0.1em]",children:"Notas"}),e.jsxs("p",{className:"text-[9px] text-text-secondary font-bold uppercase tracking-widest",children:[y.length," notas"]})]})]})}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx("input",{type:"text",value:p,onChange:t=>a(t.target.value),onKeyDown:t=>t.key==="Enter"&&v(),placeholder:"Título da nova nota…",className:"flex-1 bg-bg-base border border-border-panel rounded-md px-3 py-2 text-[11px] text-text-primary focus:outline-none focus:border-accent-orange/50 transition-colors placeholder:text-text-secondary/40"}),e.jsx("button",{onClick:v,className:"px-3 py-2 bg-accent-orange/10 border border-accent-orange/30 rounded-md text-accent-orange text-[10px] font-bold uppercase hover:bg-accent-orange/20 transition-colors",children:e.jsx(x,{name:"add",size:"sm"})})]}),e.jsxs("div",{className:"flex-1 flex gap-4 overflow-hidden min-h-0",children:[e.jsxs("div",{className:h("md:w-64 md:shrink-0 overflow-y-auto space-y-2",s?"w-full":"hidden md:block"),children:[y.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(x,{name:"note_stack",size:"lg",className:"text-text-secondary/30 mb-2"}),e.jsx("p",{className:"text-[10px] font-bold text-text-secondary/40 uppercase tracking-widest",children:"Nenhuma nota"}),e.jsx("p",{className:"text-[8px] text-text-secondary/25 mt-1",children:"Crie sua primeira nota acima"})]}),y.map(t=>e.jsx(_,{interactive:!0,onClick:()=>{m(t.id),r(!1),n(!1)},className:h("p-3 group",o===t.id&&"border-accent-orange/40 bg-accent-orange/5"),children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[11px] font-bold text-text-primary truncate",children:t.title}),e.jsx("p",{className:"text-[9px] text-text-secondary mt-1 line-clamp-2",children:t.body||"Vazia"}),e.jsx("p",{className:"text-[8px] text-text-secondary/50 mt-1",children:new Date(t.updatedAt).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),$(t.id)},className:"opacity-0 group-hover:opacity-100 text-text-secondary hover:text-accent-red transition-all shrink-0",children:e.jsx(x,{name:"delete",size:"sm"})})]})},t.id))]}),e.jsx("div",{className:h("flex-1 flex flex-col min-w-0",s?"hidden md:flex":"w-full"),children:j?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 shrink-0",children:[e.jsx("button",{onClick:()=>r(!0),className:"md:hidden text-text-secondary hover:text-text-primary p-1",children:e.jsx(x,{name:"arrow_back",size:"sm"})}),e.jsx("input",{type:"text",value:j.title,onChange:t=>{const l=t.target.value;i(c=>c.map(g=>g.id===o?{...g,title:l,updatedAt:new Date().toISOString()}:g))},className:"flex-1 bg-transparent border-none text-sm font-bold text-text-primary focus:outline-none"}),e.jsxs("div",{className:"flex items-center p-0.5 bg-bg-base rounded-sm border border-border-panel shrink-0",children:[e.jsx("button",{onClick:()=>n(!1),className:h("px-2 py-1 rounded-sm text-[9px] font-bold uppercase tracking-wider transition-colors",b?"text-text-secondary hover:text-text-primary":"bg-surface text-accent-orange border border-border-panel/40 shadow-sm"),children:"Editar"}),e.jsx("button",{onClick:()=>n(!0),className:h("px-2 py-1 rounded-sm text-[9px] font-bold uppercase tracking-wider transition-colors",b?"bg-surface text-accent-blue border border-border-panel/40 shadow-sm":"text-text-secondary hover:text-text-primary"),children:"Preview"})]}),e.jsx("span",{className:"text-[8px] text-text-secondary/50 shrink-0",children:"autosave"})]}),!b&&e.jsx("div",{className:"flex items-center gap-0.5 mb-2 p-1 bg-bg-base border border-border-panel rounded-md shrink-0 overflow-x-auto",children:D.map(t=>e.jsx("button",{onClick:()=>{k.current&&z(k.current,t.action,N)},title:t.label,className:"p-1.5 rounded-sm text-text-secondary hover:text-text-primary hover:bg-surface transition-colors shrink-0",children:e.jsx(x,{name:t.icon,size:"sm"})},t.action))}),b?e.jsx("div",{className:"flex-1 bg-bg-base border border-border-panel rounded-md p-4 text-sm text-text-primary overflow-y-auto leading-relaxed prose-sm",dangerouslySetInnerHTML:{__html:I(j.body||'<span class="text-text-secondary/30 italic">Nada para exibir</span>')}}):e.jsx("textarea",{ref:k,value:j.body,onChange:t=>N(t.target.value),placeholder:"Escreva aqui… (suporta **markdown**)",className:"flex-1 bg-bg-base border border-border-panel rounded-md p-4 text-sm text-text-primary resize-none focus:outline-none focus:border-accent-orange/30 transition-colors placeholder:text-text-secondary/30 leading-relaxed font-mono"})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[e.jsx(x,{name:"edit_note",size:"lg",className:"text-text-secondary/20 mb-2"}),e.jsx("p",{className:"text-[10px] text-text-secondary/30 font-bold uppercase tracking-widest",children:"Selecione uma nota"})]})})]})]})};export{A as default};
